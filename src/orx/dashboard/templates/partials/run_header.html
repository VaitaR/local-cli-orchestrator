<div id="run-header"
     {% if run.is_active %}
     hx-get="/partials/run-header/{{ run.run_id }}"
     hx-trigger="every {{ poll_interval }}s"
     hx-swap="outerHTML"
     {% endif %}
     class="run-header">
    
    <div class="run-title">
        <h1>{{ run.run_id }}</h1>
        <span class="badge badge-{{ run.status.value }} badge-lg">
            {{ run.status.value }}
        </span>
    </div>
    
    <div class="run-meta">
        <div class="meta-item">
            <span class="label">Stage</span>
            <span class="value">{{ run.current_stage or 'N/A' }}</span>
        </div>
        <div class="meta-item">
            <span class="label">Elapsed</span>
            <span class="value mono">{{ run.elapsed_human }}</span>
        </div>
        {% if run.repo_path %}
        <div class="meta-item">
            <span class="label">Repo</span>
            <span class="value mono">{{ run.repo_path }}</span>
        </div>
        {% endif %}
        {% if run.base_branch %}
        <div class="meta-item">
            <span class="label">Branch</span>
            <span class="value mono">{{ run.base_branch }}</span>
        </div>
        {% endif %}
        {% if run.base_sha %}
        <div class="meta-item">
            <span class="label">SHA</span>
            <span class="value mono">{{ run.base_sha[:8] }}</span>
        </div>
        {% endif %}
    </div>
    
    {% if run.last_error %}
    <div class="error-banner">
        <strong>Error:</strong> 
        {% if run.last_error.category %}{{ run.last_error.category }}: {% endif %}
        {{ run.last_error.message or 'Unknown error' }}
    </div>
    {% endif %}
    
    {% if run.is_active %}
    <div class="run-actions">
        <button class="btn btn-danger"
                hx-post="/api/runs/{{ run.run_id }}/cancel"
                hx-confirm="Cancel this run?"
                hx-swap="none"
                hx-on::after-request="setTimeout(() => htmx.trigger('#run-header', 'htmx:load'), 500)">
            Cancel Run
        </button>
    </div>
    {% endif %}
</div>
